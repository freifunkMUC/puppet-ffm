---
role::default_profiles:
  - default

profile::default::includes:
  - component::apt

profile::default::components:
  - sysctl
  - users
  - network
  - resolvconf
  - fail2ban
  - packages
  - collectd

component::apt::repos:
  - puppetlabs
  - freifunk

component::apt::ubuntu::mirror: mirror.lrz.de
component::apt::ubuntu::utopic::mirror: mirror.lrz.de

component::packages::names:
  - htop
  - iftop
  - molly-guard
  - ethtool
  - nmon
  - iotop
  - memlockd
  - strace
  - tcpdump
  - dstat

network::interfaces_hash:
  eth0:
    method: dhcp

apt::purge:
  sources.list: true
  sources.list.d: true

component::resolvconf::nameservers:
  - 213.73.91.35

component::resolvconf::template: |
  # Generated by puppet
  # all manual changes will be LOST!
  domain <%= @domain %>
  search <%= @domain %>

  <% @nameservers.sort.each do |ns| -%>
  nameserver <%= ns %>
  <% end -%>

fail2ban::bantime: 900
fail2ban::findtime: 600
fail2ban::maxretry: 3

chrony::servers: [ '0.ntp.ffmuc.net', 'de.pool.ntp.org' ]
chrony::serve_ntp: true
chrony::client_allow: [ '10.80.0.0/16', 'fdef:ffc0:4fff::/48' ]

collectd::purge: true
collectd::purge_config: true
collectd::recurse: true
collectd::interval: 30

component::collectd::plugin_classes:
  - syslog
  - cpu
  - df
  - disk
  - entropy
  - interface
  - load
  - memory
  - processes
  - swap
  - users
  - write_graphite

collectd::plugin::df::ignoreselected: true
collectd::plugin::df::fstypes:
  - rootfs
  - sysfs
  - proc
  - devtmpfs
  - devpts
  - fusectl
  - cgroup
  - tmpfs
  - vboxsf

collectd::plugin::write_graphite::carbon_defaults:
  protocol: tcp
  storerates: true
  graphiteprefix: 'servers.'

component::users::collections:
  - admin

component::users::admin::defaults:
  groups:
    - sudo
    - adm

component::users::admin:
  fpletz:
    password: '$6$Gfcm1ilr$Egw6rSSadO/sSB/7NknhieJN./6zLQDjcNRu/vlm3j3qTHDn4xTrue2hYBD04BvTlA7JRXp9UTBczKrtEOITm0'
    ssh_authorized_keys:
      ffmucpletz:
        type: ssh-ed25519
        key:  AAAAC3NzaC1lZDI1NTE5AAAAIKuIAJJ28E7ak1w8qb7zJSbSROnsEKMul4tfuOVkAha0
  fadenb:
    password: '$6$b2Wxzp2m$wsJ9PY7KeacQP/eaIuzC8xazJSf9a8OX0Oo/PtTEAMyruyf58Mh7C0d5YCNkhuDG3b.vIiOQsuo8akiXYUfac.'
    ssh_authorized_keys:
      p4x382:
        type: 'ssh-rsa'
        key:  'AAAAB3NzaC1yc2EAAAADAQABAAACAQCrdelMia5gDDkEUC0lfRXxKQo0oPVpg/MxZAX44MGxqE+jgBk7VoIw6YvGcoeLboDh0SIuWXMIkVzWIF1CCpcKlhJ1GaMFH7URCQvJd636SO9sg3bjoRENh8GJaQpgKp+yeH7wvfwSpkrk7RoadfvTu0KGTUH8J5f3GTZU4CHAn9PfAv4+BVPvM6DRLxIJJA6/zFWW42Q5A9rUOgdpua+5xzCKJ0AHaVRoE935kXC2DogxHWQaJ45EeqPZJHCyuZRqTRpGKTQBMWWrmk4R+bJtUME+xmvf1cG5RCy1/8YPEkBfv2GbmVFSomH9ZeaMQRd8ZOcUitYzcxF1HJwxsSqCUTdt1JTYu/qyhXl1fNFfAW1+oWIDzbeaY5oZQzRH3pl/bf2uvoLHXgNZz5Dkgj8FdUjpGML9kUq2/aH3sLtOPO5NKnJcGPBjTfKL91z21nlBfVw4+Yi6J5h/ORsucJsR9HjDuBsudjSL0PTrYzZkAGZE5CrU8t/6IS++VUDCCYA4XITcMNIb5gnav20Wn8UUg4zZh+M6cPTmFONCLsYcsEBgspuPQT0TwWVdDYoSmlVrEngGeeVARGQJ6Hr70VkmNX0hrVkudlrjWjidxVmIBCpHehk9ucLRCFvBfcV9h6McpeXvFERKOyUel3+4Q8bacgzjZd0tXHonJwHhVOxhdw=='
  ruebezahl:
    ssh_authorized_keys:
      ruebezahl:
        type: 'ssh-rsa'
        key:  'AAAAB3NzaC1yc2EAAAABIwAAAQEA5PD0xVViVQd5qgE2E4iC8ZWLIg8rmhz1Zb7NJgcA/uwvLTsc1aNW5c16qVWQot37EMHTeh1emr6C0oqNXSOsLWlOfcIHuV/QlVFhxiFZjCv/MWenb2US0mS9po7OS1v+zDAfotb2uUf2MPuaOEcnzToCUu4fa2Guh6YqislWfdFJRbA6rHZtWR48t1cJjhYI5KuF4Y2ef3yMDohTBXcA+oy8rKEfrCJuUaxzqlJPzKRsu1i0mooOvIehBUxAecmRBruBnamTf2NYestshazVkFKnUFf9gk25t6dVuT4UiMjBZdT6lqlbyW+RUtJTa6t65oUj4WfSp9Qt5GS172Ko0w=='
